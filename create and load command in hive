A. create database
------------------
create database niit;

--this creates a folder by the name of retail.db under /user/hive/warehouse

A1. show all the databases in hive
----------------------------------
show databases;

B. Select a database
--------------------
use niit;

B1. Show tables under the database
----------------------------------
show tables;


C1. Create transaction table
-------------------------------
create table txnrecords(txnno INT, txndate STRING, custno INT, amount DOUBLE, 
category STRING, product STRING, city STRING, state STRING, spendby STRING)
row format delimited
fields terminated by ','
stored as textfile;

C2. Create customer table
-------------------------------
create table customer(custno INT, firstname STRING, lastname STRING, age INT, profession STRING)
row format delimited
fields terminated by ','
stored as textfile;

 
D1. Load the data into the table (from local file system)
-----------------------------------------------------
LOAD DATA LOCAL INPATH '/home/hduser/txns1.txt' OVERWRITE INTO TABLE txnrecords;

LOAD DATA LOCAL INPATH '/home/hduser/custs' OVERWRITE INTO TABLE customer;

LOAD DATA LOCAL INPATH '/home/hduser/custs_add' INTO TABLE customer;


to save the file on hdfs
-------------------------
INSERT OVERWRITE DIRECTORY '/hive/Customer/CustCount' row format delimited fields terminated by ',' 
select profession, count(*) from customer group by profession;

N1. how do i know i am in which database currently
--------------------------------------------------
set hive.cli.print.current.db=true;

N2. how do i print my headers of my table
-------------------------------------
set hive.cli.print.header=true;

check the detailed desc about table
-------------------------------------
desc formatted customer;




create table for NYSE and load
-----------------------------


create table NYSE(
exchange_name string,
stock_id string,
stock_date date,
open double,
high double,
low double,
close double,
volume bigint,
adj_close double)
row format delimited
fields terminated by ','
stored as textfile;


upload data on hdfs
-------------------
LOAD DATA LOCAL INPATH '/home/hduser/NYSE.csv' OVERWRITE INTO TABLE NYSE;

queries
--------
1. count the number of records in nyse.csv.
Ans:-
INSERT OVERWRITE DIRECTORY '/hive/NYSE/StockCount' row format delimited fields terminated by ',' 
select count(*) from NYSE;

2. Find the total stock volume for each stock.. order it on highest vol wise
Ans:- 
INSERT OVERWRITE DIRECTORY '/hive/NYSE/StockHighVol' row format delimited fields terminated by ',' 
select sum(volume) as Vol, stock_id from NYSE group by stock_id order by Vol desc;

3. Find the top5 max variance in a desc order and save o/p in hdfs
Ans:- 
It will save output in hdfs
INSERT OVERWRITE DIRECTORY '/hive/NYSE/Top5Variance' row format delimited fields terminated by ',' 
select stock_id, round(max((high-low)/low*100),2) as maxvar from NYSE group by stock_id order by maxvar desc limit 5;

It will save output in local system
INSERT OVERWRITE local DIRECTORY '/home/hduser/top5variance' row format delimited fields terminated by ',' 
select stock_id, round(max((high-low)/low*100),2) as maxvar from NYSE group by stock_id order by maxvar desc limit 5;






